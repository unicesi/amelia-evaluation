package edu.icesi.amelia.validation.cts.subsystems

import org.amelia.dsl.lib.descriptors.Host
import java.util.List

includes Common

//depends on ExternalProbe

subsystem Compilation
{

	param String codeSourcesFolder	
	param List<Host> associatedHosts
	
	var Host host = new Host(hostIp,21,22,"carvajal","hgrid18", hostId)
	
	//param Host serverHost
	//param Host queueHost
	//param Host intermHost
	//param List<Host> consumHosts
	
	//var List<Host> associatedHosts = (#[serverHost,queueHost,intermHost] + consumHosts).toList
	
	
	
	var Boolean transmit = true
	
	on host
	{
		
		directory:
			
			cd codeSourcesFolder
		
		compilation:directory;
			
			compile "Procedimientos_PDG/Server/src" "Procedimientos_PDG/jars/xmlServer" -classpath #[
				"Procedimientos_PDG/lib/vtd-xml.jar",
				"Procedimientos_PDG/lib/org.pascani.dsl.lib-0.0.1-SNAPSHOT-dependencies.jar",
				"Procedimientos_PDG/lib/new-personalized-events-with-carvajal.jar",
				"Procedimientos_PDG/lib/ojdbc6.jar",
				"Procedimientos_PDG/lib/javax.ws.rs-api-2.0.jar",
				"Procedimientos_PDG/lib/commons-codec-1.10.jar",
				"Procedimientos_PDG/lib/xdb6.jar"]
			
			compile "Procedimientos_PDG/IntermediateControl/src" "Procedimientos_PDG/jars/xmlIntermedio" -classpath #[
				"Procedimientos_PDG/lib/org.pascani.dsl.lib-0.0.1-SNAPSHOT-dependencies.jar",
				"Procedimientos_PDG/lib/new-personalized-events-with-carvajal.jar"]
				
			compile "Procedimientos_PDG/Queue/src" "Procedimientos_PDG/jars/xmlQueue" -classpath #[
				"Procedimientos_PDG/lib/org.pascani.dsl.lib-0.0.1-SNAPSHOT-dependencies.jar",
				"Procedimientos_PDG/lib/new-personalized-events-with-carvajal.jar"]
				
			compile "Monitoring/src" "monitoring" -classpath #[
				"Monitoring/lib/org.pascani.dsl.lib-0.0.1-SNAPSHOT-dependencies.jar",
				"Monitoring/lib/new-personalized-events-with-carvajal.jar",
				"Monitoring/lib/slf4j-api-1.7.10.jar",
				"Monitoring/lib/sigar.jar"]
				
		localCopy:compilation;
		
			cmd "cp -rf " + "Procedimientos_PDG/jars " + "/home/carvajal/nfs/Carvajal/"
			cmd "cp " + "monitoring.jar " + "/home/carvajal/nfs/Carvajal/jars"
			//cmd "cp -rf " + "Procedimientos_PDG/lib " + "/home/carvajal/nfs/Carvajal"
			
	}
	
	on associatedHosts ? transmit
	{
		remoteCopy:localCopy;
		
			cmd "cp -rf " + "/home/carvajal/nfs/Carvajal/jars " + "/home/carvajal/Documents/carvajal"
			cmd "cp -rf " + "/home/carvajal/nfs/Carvajal/lib " + "/home/carvajal/Documents/carvajal" 
	}
	
//	on consumHosts ? transmit
//	{
//		transferConsums:localCopy;
//		
//			cmd "cp -rf " + "/home/carvajal/nfs/Carvajal/jars " + "/home/carvajal/Documents/carvajal"
//			cmd "cp -rf " + "/home/carvajal/nfs/Carvajal/lib " + "/home/carvajal/Documents/carvajal"
//	}
	
}